"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("react"),D=require("@ecency/render-helper"),Y=require("clsx"),T=require("medium-zoom"),s=require("react/jsx-runtime"),m=require("react-dom/client");function $({containerRef:a}){const t=d.useRef(void 0);return d.useEffect(()=>{var n,r,o;Array.from(((n=a.current)==null?void 0:n.querySelectorAll(".markdown-view:not(.markdown-view-pure) img"))??[]).filter(i=>{try{if(!i.isConnected)return!1;const c=i.parentNode;return c?c.nodeName!=="A"&&!i.classList.contains("medium-zoom-image")&&!i.closest(".markdown-image-container"):!1}catch(c){return console.warn("Error accessing image element properties:",c),!1}}).forEach(i=>{var c,l,h;try{if(!i.isConnected){console.warn("Image element is no longer connected to DOM, skipping");return}if(!i.parentElement){console.warn("Image element has no parent, skipping");return}const u=document.createElement("div");u.classList.add("markdown-image-container");const w=i.cloneNode(!0),f=(c=i.getAttribute("title"))==null?void 0:c.trim(),y=(l=i.getAttribute("data-caption"))==null?void 0:l.trim(),g=(h=i.getAttribute("alt"))==null?void 0:h.trim(),V=g?/^[\w,\s-]+\.(jpg|jpeg|png|gif|webp|bmp|svg)$/i.test(g):!1,N=f||y||(V?"":g);if(N){const x=document.createElement("div");x.classList.add("markdown-img-caption"),x.innerText=N,u.appendChild(w),u.appendChild(x)}else u.appendChild(w);i.isConnected&&i.parentElement&&i.parentElement.replaceChild(u,i)}catch(p){console.warn("Error enhancing image element:",p)}});try{const i=Array.from(((r=a.current)==null?void 0:r.querySelectorAll(".markdown-view:not(.markdown-view-pure) img"))??[]).filter(c=>{try{return c.isConnected&&c.parentNode!==null}catch{return!1}});i.length>0&&(t.current=T(i),(o=t.current)==null||o.update({background:"#131111"}))}catch(i){console.warn("Failed to initialize medium-zoom:",i)}return()=>{var i;(i=t.current)==null||i.detach()}},[]),s.jsx(s.Fragment,{})}function k(a){try{const t=new URL(a,"https://ecency.com").pathname.split("/").filter(Boolean).pop()??"";return t.includes("re-ecencywaves")||t.includes("re-leothreads")||t.startsWith("wave-")||t.startsWith("re-liketu-moments")}catch{return!1}}const Z=".markdown-view:not(.markdown-view-pure) a",K=new Set(["ecency.com","www.ecency.com","peakd.com","www.peakd.com","hive.blog","www.hive.blog"]);function G(a){return a.trim().replace(/^https?:\/\/(www\.)?(ecency\.com|peakd\.com|hive\.blog)/i,"").replace(/^\/+/,"").split("?")[0].replace(/#@.*$/i,"").replace(/\/+$/,"").toLowerCase()}function v(a){return Array.from(a.querySelectorAll(Z)).filter(e=>{if((e.dataset.isInline??"").toLowerCase()==="true")return!1;if(e.dataset.postLinkChecked==="true")return e.classList.contains("markdown-post-link");if(e.dataset.postLinkChecked="true",(e.dataset.isInline??"").toLowerCase()==="true")return!1;if(e.classList.contains("markdown-post-link"))return!0;const n=e.getAttribute("href")??"";if(!n)return!1;try{const r=new URL(n,"https://ecency.com");if(r.protocol&&!/^https?:$/.test(r.protocol)||r.hostname&&r.hostname!==""&&!K.has(r.hostname)||r.hash.startsWith("#@"))return!1;const o=r.pathname.split("/").filter(Boolean);if(o.length<2)return!1;const i=decodeURIComponent(o.pop()??""),c=decodeURIComponent(o.pop()??"");if(!c.startsWith("@")||!i||!(o.length===0||o.length===1&&o[0].toLowerCase().startsWith("hive-")))return!1;const h=G(e.innerText),p=`${c}/${i}`.toLowerCase(),u=o.length===1?decodeURIComponent(o[0]).toLowerCase():void 0,w=new Set([p]);return u&&w.add(`${u}/${p}`),e.innerText.trim()===n.trim()||w.has(h)?(e.classList.add("markdown-post-link"),!0):!1}catch{return!1}})}const E=new Map;function P(a){try{const t=new URL(`https://ecency.com${a}`).pathname.split("/"),e=decodeURIComponent(t[3]||""),n=/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(e),r=/[?#]/.test(e);return!/^[a-z0-9-]+$/.test(e)||n||r}catch{return!0}}function L({link:a}){const[t,e]=d.useState(),n=d.useMemo(()=>new URL(a,"https://ecency.com"),[a]),r=n.pathname.toLowerCase(),o=d.useCallback(async()=>{var c,l,h,p;if(E.has(r)){e(E.get(r));return}if(P(r)){console.warn("[Ecency Renderer] Skipping invalid post link:",r);return}try{const w=await(await fetch(`https://ecency.com${r}`,{method:"GET"})).text(),f=document.createElement("html");f.innerHTML=w;const y=(c=f.querySelector('meta[property="og:title"]'))==null?void 0:c.getAttribute("content");if(y){const g={title:y,description:((h=(l=f.querySelector('meta[property="og:description"]'))==null?void 0:l.getAttribute("content"))==null?void 0:h.substring(0,71))??void 0,image:((p=f.querySelector('meta[property="og:image"]'))==null?void 0:p.getAttribute("content"))??void 0};E.set(r,g),e(g)}}catch(u){console.error(`[Ecency Renderer] Failed to fetch preview: ${a}`,u)}},[r,a]);d.useEffect(()=>{o()},[o]);const i=d.useMemo(()=>{const c=new URL(n.href),l=c.searchParams.get("referral");return`${c.pathname}${l?`?referral=${l}`:""}${c.hash}`},[n]);return s.jsx("a",{href:i,className:"ecency-renderer-hive-post-extension-link",target:"_blank",rel:"noopener",children:t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ecency-renderer-hive-post-extension-link-image",style:{backgroundImage:`url(${t.image})`}}),s.jsxs("div",{className:"ecency-renderer-hive-post-extension-link-text-content",children:[s.jsx("div",{className:"ecency-renderer-hive-post-extension-link-type",children:"Hive post"}),s.jsx("div",{className:"ecency-renderer-hive-post-extension-link-title",children:t.title}),s.jsx("div",{className:"ecency-renderer-hive-post-extension-link-description",children:t.description+"..."})]})]}):a})}function I({containerRef:a}){return d.useEffect(()=>{const t=a.current;t&&v(t).filter(e=>!k(e.getAttribute("href")??"")).filter(e=>{try{const n=new URL(e.getAttribute("href")??"","https://ecency.com");return!P(n.pathname)}catch{return!1}}).forEach(e=>{var i;if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=document.createElement("div");n.classList.add("ecency-renderer-hive-post-extension");const r=e.getAttribute("href")??"";m.createRoot(n).render(s.jsx(L,{link:r})),(i=e.parentElement)==null||i.replaceChild(n,e)})},[]),null}function A({author:a}){const t=`https://images.ecency.com/u${a.toLowerCase().replace("@","")}/avatar/small`;return s.jsxs(s.Fragment,{children:[s.jsx("img",{src:t,className:"ecency-renderer-author-extension-link-image",alt:a}),s.jsxs("div",{className:"ecency-renderer-author-extension-link-content",children:[s.jsx("span",{className:"ecency-renderer-author-extension-link-content-label",children:"Hive account"}),s.jsx("span",{children:a.toLowerCase().replace("/","")})]})]})}function q({containerRef:a}){return d.useEffect(()=>{var e;Array.from(((e=a.current)==null?void 0:e.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-author-link"))??[]).forEach(n=>{var c;if(n.dataset.enhanced==="true")return;const r=n.getAttribute("href");if(!r)return;const o=document.createElement("a");o.setAttribute("href",r),o.setAttribute("target","_blank"),o.setAttribute("rel","noopener"),o.classList.add("ecency-renderer-author-extension"),o.classList.add("ecency-renderer-author-extension-link"),m.createRoot(o).render(s.jsx(A,{author:r})),(c=n.parentElement)==null||c.replaceChild(o,n),o.dataset.enhanced="true"})},[]),null}function H({tag:a}){return s.jsx("span",{children:a.replace("/","")})}function W({containerRef:a}){return d.useEffect(()=>{var e;Array.from(((e=a.current)==null?void 0:e.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-tag-link"))??[]).forEach(n=>{var i;const r=document.createElement("a");r.setAttribute("href",n.getAttribute("href")??""),r.setAttribute("target","_blank"),r.setAttribute("rel","noopener"),r.classList.add("ecency-renderer-tag-extension"),r.classList.add("ecency-renderer-tag-extension-link"),m.createRoot(r).render(s.jsx(H,{tag:n.innerText})),(i=n.parentElement)==null||i.replaceChild(r,n)})},[]),null}function _(a){try{const t=new URL(a);let e="";if(t.hostname==="youtu.be"?e=t.pathname.slice(1):t.pathname.startsWith("/shorts/")?e=t.pathname.split("/shorts/")[1]:t.pathname.startsWith("/embed/")?e=t.pathname.split("/embed/")[1]:e=t.searchParams.get("v")??"",!e)return"";const n=new URLSearchParams,r=t.searchParams.get("t")||t.searchParams.get("start")||t.searchParams.get("time_continue");if(r){const c=J(r);c&&n.set("start",c.toString())}const o=t.searchParams.get("list");o&&n.set("list",o),n.set("rel","0"),n.set("modestbranding","1");const i=n.toString();return`https://www.youtube.com/embed/${e}${i?`?${i}`:""}`}catch{return""}}function J(a){const t=/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?/,e=a.match(t);if(e&&(e[1]||e[2]||e[3])){const r=parseInt(e[1]||"0",10),o=parseInt(e[2]||"0",10),i=parseInt(e[3]||"0",10);return r*3600+o*60+i}const n=parseInt(a,10);return Number.isNaN(n)?void 0:n}function j({embedSrc:a,container:t}){const[e,n]=d.useState(!1);return d.useEffect(()=>{const r=()=>n(!0);return t.addEventListener("click",r),()=>t.removeEventListener("click",r)},[]),d.useEffect(()=>{if(e){const r=t.querySelector(".video-thumbnail"),o=t.querySelector(".markdown-video-play");r&&(r.style.display="none"),o&&(o.style.display="none")}},[e]),e?s.jsx("iframe",{className:"youtube-shorts-iframe",src:a,title:"Video player",frameBorder:"0",allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0}):null}function F({containerRef:a}){return d.useEffect(()=>{var e;Array.from(((e=a.current)==null?void 0:e.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-video-link-youtube:not(.ecency-renderer-youtube-extension)"))??[]).forEach(n=>{const r=n.dataset.embedSrc||_(n.getAttribute("href")??"");n.dataset.embedSrc=r;const o=document.createElement("div");o.classList.add("ecency-renderer-youtube-extension-frame"),n.classList.add("ecency-renderer-youtube-extension"),m.hydrateRoot(o,s.jsx(j,{embedSrc:r,container:n})),n.appendChild(o)})},[]),s.jsx(s.Fragment,{})}const b=new Map;async function Q(a,t){if(b.has(`${a}/${t}`))return b.get(`${a}/${t}`);const e=await window.dHiveClient.call("condenser_api","get_content",[a,t]);return b.set(`${a}/${t}`,e),e}const X='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 148.85 148.85"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><circle class="ecency-logo-circle" cx="74.43" cy="74.43" r="74.43"/><path class="ecency-logo-sign" d="M88.27,105.71c-9,.08-30.35.27-35.13-.29-3.88-.46-11-3-11.11-12.81C42,87,41.66,64,42.46,59,44.13,48.4,47,41.77,59.05,36.33c10.26-4.44,32.17-.78,34.54,16.93.45,3.37,1.25,3.74,2.49,4,19.61,4.13,24,26.26,14.6,38.32C104.73,103.26,98.31,104.76,88.27,105.71ZM84.71,59.25c.68-11.52-11-19.82-22.82-13.66-8.42,4.39-9.15,10.76-9.68,18-.67,9.2-.25,15.91-.09,25.13.07,4.13,1.27,6.64,5.7,7,1.14.1,17,0,25.22.06,10.74.06,24.06-4.89,21.93-18a12.68,12.68,0,0,0-10.8-10.22,2.12,2.12,0,0,0-2.21,1C85,83,69.66,82.31,63.41,74.46c-5.61-7.06-2.7-18.73,4.68-21.2,2.78-.94,5.11-.11,6.25,1.86,1.84,3.18.11,6.06-2.49,7.65s-2.45,3.92-1.36,5.46c2.56,3.59,7.6,2.88,10.79-.28C83.87,65.4,84.52,62.47,84.71,59.25Z"/></g></g></svg>';function S({link:a}){const[t,e]=d.useState(),n=d.useMemo(()=>{var o,i,c,l;return(o=t==null?void 0:t.permlink)!=null&&o.startsWith("re-ecencywaves")||(i=t==null?void 0:t.permlink)!=null&&i.startsWith("wave-")?"ecency.waves":(c=t==null?void 0:t.permlink)!=null&&c.startsWith("re-leothreads")?"threads":(l=t==null?void 0:t.permlink)!=null&&l.startsWith("re-liketu-moments")?"moments":""},[t]);if(d.useEffect(()=>{const[o,i,c,l,h]=new URL(a,"https://ecency.com").pathname.split("/");Q(l.replace("@",""),h).then(p=>{e(p)}).catch(p=>console.error(p))},[]),!t)return s.jsx(s.Fragment,{});const r=`/waves/${t.author}/${t.permlink}`;return s.jsxs("article",{className:"ecency-renderer-wave-like-post-extension-renderer",children:[s.jsx("a",{href:r,"aria-label":`Open wave by @${t.author}`,className:"ecency-renderer-wave-like-post-extension-renderer__overlay"}),s.jsxs("div",{className:"ecency-renderer-wave-like-post-extension-renderer--author",children:[s.jsx("img",{src:`https://images.ecency.com/u/${t.author}/avatar/small`,alt:t.author,className:"ecency-renderer-wave-like-post-extension-renderer--author-avatar"}),s.jsxs("div",{className:"ecency-renderer-wave-like-post-extension-renderer--author-content",children:[s.jsxs("a",{className:"ecency-renderer-wave-like-post-extension-renderer--author-content-link",href:`/@${t.author}/posts`,children:["@",t.author]}),s.jsxs("div",{className:"ecency-renderer-wave-like-post-extension-renderer--author-content-host",children:["#",n]})]})]}),s.jsx("a",{href:"https://ecency.com",className:"ecency-renderer-wave-like-post-extension-renderer--logo",dangerouslySetInnerHTML:{__html:X}}),s.jsx("div",{className:"ecency-renderer-wave-like-post-extension-renderer--body",children:s.jsx(B,{value:t.body})})]})}function M({containerRef:a}){return d.useEffect(()=>{const t=a.current;t&&v(t).filter(e=>k(e.getAttribute("href")??"")).forEach(e=>{var r;const n=document.createElement("div");n.classList.add("ecency-renderer-wave-like-extension"),m.hydrateRoot(n,s.jsx(S,{link:e.getAttribute("href")??""})),(r=e.parentElement)==null||r.replaceChild(n,e)})},[]),s.jsx(s.Fragment,{})}function R({op:a}){const t=d.useMemo(()=>{try{const n=atob(a);return JSON.parse(n)}catch{return}},[a]),e=d.useMemo(()=>t==null?void 0:t[0].split("_").join(" "),[t]);return s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"ecency-renderer-hive-operation-extension-label",children:"Hive operation, click to Sign"}),!t&&a,s.jsx("div",{className:"ecency-renderer-hive-operation-extension-content",children:t&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ecency-renderer-hive-operation-extension-type",children:e}),e==="transfer"&&s.jsxs("div",{className:"ecency-renderer-hive-operation-extension-transfer",children:[s.jsx("span",{className:"ecency-renderer-hive-operation-extension-transfer-highlight",children:t[1].amount}),s.jsx("span",{children:" to"}),s.jsx("img",{src:`https://images.ecency.com/u/${t[1].to}/avatar/small`,className:"ecency-renderer-hive-operation-extension-transfer-image",alt:""}),s.jsx("span",{className:"ecency-renderer-hive-operation-extension-transfer-highlight",children:t[1].to})]})]})})]})}function U({containerRef:a,onClick:t}){return d.useEffect(()=>{var e;Array.from(((e=a.current)==null?void 0:e.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-external-link"))??[]).filter(n=>{var r;return(r=n.innerText)==null?void 0:r.startsWith("hive://sign/op/")}).forEach(n=>{var c;const r=document.createElement("div");r.classList.add("ecency-renderer-hive-operation-extension");const o=n.innerText.replace("hive://sign/op/","");r.addEventListener("click",()=>t==null?void 0:t(o)),m.createRoot(r).render(s.jsx(R,{op:o})),(c=n.parentElement)==null||c.replaceChild(r,n)})},[a,t]),null}function O({containerRef:a,ComponentInstance:t}){return d.useEffect(()=>{var n;Array.from(((n=a.current)==null?void 0:n.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-external-link"))??[]).filter(r=>{const o=r.getAttribute("href")||"";return o.startsWith("https://x.com")||o.startsWith("https://twitter.com")}).forEach(r=>{try{const o=r.getAttribute("href");if(!o)return;const c=new URL(o).pathname.split("/").pop();if(!c)return;const l=document.createElement("div");l.classList.add("ecency-renderer-twitter-extension-frame"),r.classList.add("ecency-renderer-twitter-extension"),r.innerHTML="",r.appendChild(l),m.createRoot(l).render(s.jsx(t,{id:c}))}catch(o){console.warn("TwitterExtension failed to render tweet:",o)}})},[a]),null}function C({embedSrc:a,container:t}){const[e,n]=d.useState(!1);return d.useEffect(()=>{const r=()=>n(!0);return t.addEventListener("click",r),()=>t.removeEventListener("click",r)},[]),d.useEffect(()=>{if(e){const r=t.querySelector(".video-thumbnail"),o=t.querySelector(".markdown-video-play");r&&(r.style.display="none"),o&&(o.style.display="none")}},[e]),e?s.jsx("iframe",{className:"speak-iframe",src:a,title:"3Speak video",frameBorder:"0",allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0}):null}function z({containerRef:a}){return d.useEffect(()=>{var e;Array.from(((e=a.current)==null?void 0:e.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-video-link-speak:not(.ecency-renderer-speak-extension)"))??[]).forEach(n=>{const r=document.createElement("div");r.classList.add("ecency-renderer-speak-extension-frame"),n.classList.add("ecency-renderer-speak-extension"),m.hydrateRoot(r,s.jsx(C,{embedSrc:n.dataset.embedSrc??"",container:n})),n.appendChild(r)})},[]),s.jsx(s.Fragment,{})}function B({value:a,pure:t=!1,onHiveOperationClick:e,TwitterComponent:n=()=>s.jsx("div",{children:"No twitter component"}),...r}){const o=d.useRef(null);return s.jsxs(s.Fragment,{children:[s.jsx("div",{...r,ref:o,itemProp:"articleBody",className:Y.clsx("entry-body markdown-view user-selectable",t?"markdown-view-pure":"",r.className),dangerouslySetInnerHTML:{__html:D.renderPostBody(a,!1)}}),!t&&s.jsxs(s.Fragment,{children:[s.jsx($,{containerRef:o}),s.jsx(I,{containerRef:o}),s.jsx(q,{containerRef:o}),s.jsx(W,{containerRef:o}),s.jsx(F,{containerRef:o}),s.jsx(z,{containerRef:o}),s.jsx(M,{containerRef:o}),s.jsx(O,{containerRef:o,ComponentInstance:n}),s.jsx(U,{containerRef:o,onClick:e})]})]})}function ee(a){Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) img")).filter(e=>{try{if(!e.isConnected)return!1;const n=e.parentNode;return n?n.nodeName!=="A"&&!e.classList.contains("medium-zoom-image")&&!e.closest(".markdown-image-container"):!1}catch(n){return console.warn("Error accessing image element properties:",n),!1}}).forEach(e=>{var n,r,o;try{if(!e.isConnected){console.warn("Image element is no longer connected to DOM, skipping");return}if(!e.parentElement){console.warn("Image element has no parent, skipping");return}const c=document.createElement("div");c.classList.add("markdown-image-container");const l=e.cloneNode(!0),h=(n=e.getAttribute("title"))==null?void 0:n.trim(),p=(r=e.getAttribute("data-caption"))==null?void 0:r.trim(),u=(o=e.getAttribute("alt"))==null?void 0:o.trim(),w=u?/^[\w,\s-]+\.(jpg|jpeg|png|gif|webp|bmp|svg)$/i.test(u):!1,f=h||p||(w?"":u);if(f){const y=document.createElement("div");y.classList.add("markdown-img-caption"),y.innerText=f,c.appendChild(l),c.appendChild(y)}else c.appendChild(l);e.isConnected&&e.parentElement&&e.parentElement.replaceChild(c,e)}catch(i){console.warn("Error enhancing image element:",i)}});try{const e=Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) img")).filter(n=>{try{return n.isConnected&&n.parentNode!==null}catch{return!1}});e.length>0&&T(e).update({background:"#131111"})}catch(e){console.warn("Failed to initialize medium-zoom:",e)}}function te(a,t=v(a)){t.filter(e=>e.dataset.isInline!=="true").filter(e=>!k(e.getAttribute("href")??"")).forEach(e=>{var i;if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=e.getAttribute("href")??"",r=document.createElement("div");r.classList.add("ecency-renderer-hive-post-extension"),m.createRoot(r).render(s.jsx(L,{link:n})),(i=e.parentElement)==null||i.replaceChild(r,e)})}function re(a,t){Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-external-link")).filter(e=>e.innerText.startsWith("hive://sign/op/")).forEach(e=>{var i;if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=e.innerText.replace("hive://sign/op/",""),r=document.createElement("div");r.classList.add("ecency-renderer-hive-operation-extension"),r.addEventListener("click",()=>t==null?void 0:t(n)),m.createRoot(r).render(s.jsx(R,{op:n})),(i=e.parentElement)==null||i.replaceChild(r,e)})}function ne(a){Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-author-link")).forEach(e=>{var i;if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=e.getAttribute("href");if(!n)return;const r=document.createElement("a");r.href=n,r.target="_blank",r.rel="noopener",r.classList.add("ecency-renderer-author-extension","ecency-renderer-author-extension-link"),m.createRoot(r).render(s.jsx(A,{author:n})),(i=e.parentElement)==null||i.replaceChild(r,e)})}function ae(a){a.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-tag-link").forEach(e=>{e.classList.add("ecency-renderer-tag-link-enhanced")})}function se(a){Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-video-link-youtube:not(.ecency-renderer-youtube-extension)")).forEach(e=>{if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=e.dataset.embedSrc||_(e.getAttribute("href")??"");e.dataset.embedSrc=n;const r=document.createElement("div");r.classList.add("ecency-renderer-youtube-extension-frame"),m.createRoot(r).render(s.jsx(j,{embedSrc:n,container:e})),e.appendChild(r)})}function oe(a){Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-video-link-speak:not(.ecency-renderer-speak-extension)")).forEach(e=>{if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=e.dataset.embedSrc??"",r=document.createElement("div");r.classList.add("ecency-renderer-speak-extension-frame"),m.createRoot(r).render(s.jsx(C,{embedSrc:n,container:e})),e.appendChild(r)})}function ie(a,t){Array.from(a.querySelectorAll(".markdown-view:not(.markdown-view-pure) .markdown-external-link")).filter(n=>{const r=n.getAttribute("href")||"";if(!r.startsWith("https://x.com")&&!r.startsWith("https://twitter.com"))return!1;try{const i=new URL(r).pathname.split("/").filter(Boolean);return i.length>=3&&i[1]==="status"&&/^\d+$/.test(i[2])}catch{return!1}}).forEach(n=>{try{if(n.dataset.enhanced==="true")return;n.dataset.enhanced="true";const r=n.getAttribute("href");if(!r)return;const c=new URL(r).pathname.split("/").filter(Boolean)[2];if(!c)return;const l=document.createElement("div");l.classList.add("ecency-renderer-twitter-extension-frame"),n.innerHTML="",n.appendChild(l),m.createRoot(l).render(s.jsx(t,{id:c}))}catch(r){console.warn("applyTwitterEmbeds failed to render tweet:",r)}})}function ce(a,t=v(a)){t.filter(e=>e.dataset.isInline!=="true").filter(e=>k(e.getAttribute("href")??"")).forEach(e=>{var i;if(e.dataset.enhanced==="true")return;e.dataset.enhanced="true";const n=e.getAttribute("href")??"",r=document.createElement("div");r.classList.add("ecency-renderer-wave-like-extension"),m.createRoot(r).render(s.jsx(S,{link:n})),(i=e.parentElement)==null||i.replaceChild(r,e)})}const de=({id:a})=>d.createElement("div",{style:{padding:"16px",border:"1px solid #e1e8ed",borderRadius:"8px",backgroundColor:"#f7f9fa",color:"#657786",textAlign:"center"}},`Failed to load tweet. View on Twitter: https://twitter.com/i/status/${a}`);function le(a,t){ee(a);const e=v(a);te(a,e),ne(a),re(a,t==null?void 0:t.onHiveOperationClick),ae(a),se(a),oe(a),ce(a,e),ie(a,(t==null?void 0:t.TwitterComponent)??de)}exports.AuthorLinkExtension=q;exports.AuthorLinkRenderer=A;exports.EcencyRenderer=B;exports.HiveOperationExtension=U;exports.HiveOperationRenderer=R;exports.HivePostLinkExtension=I;exports.HivePostLinkRenderer=L;exports.ImageZoomExtension=$;exports.TagLinkExtension=W;exports.TagLinkRenderer=H;exports.ThreeSpeakVideoExtension=z;exports.ThreeSpeakVideoRenderer=C;exports.TwitterExtension=O;exports.WaveLikePostExtension=M;exports.WaveLikePostRenderer=S;exports.YoutubeVideoExtension=F;exports.YoutubeVideoRenderer=j;exports.findPostLinkElements=v;exports.isWaveLikePost=k;exports.setupPostEnhancements=le;
